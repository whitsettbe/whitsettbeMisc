<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>MPC Sign In</title>
	<script>
		// cookie getter/setter from https://www.w3schools.com/js/js_cookies.asp

		function setCookie(cname, cvalue, exdays)
		{
			const d = new Date();
			d.setTime(d.getTime() + (exdays*24*60*60*1000));
			let expires = "expires="+ d.toUTCString();
			document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
		  }
			
		function getCookie(cname)
		{
			let name = cname + "=";
			let decodedCookie = decodeURIComponent(document.cookie);
			let ca = decodedCookie.split(';');
			for(let i = 0; i <ca.length; i++)
			{
				let c = ca[i];
				while (c.charAt(0) == ' ')
				{
					c = c.substring(1);
				}
				if (c.indexOf(name) == 0)
				{
					return c.substring(name.length, c.length);
				}
			}
			return "";
		}

		function loadBehaviors()
		{
			document.getElementById('email').value = getCookie('email');
			time = getCookie('time');
			if (time == '')
			{
				time = 'never';
			}
			document.getElementById('timeLog').innerHTML = 'Last sign-in: ' + time;
		}

		function submitBehaviors()
		{
			setCookie('email', document.getElementById('email').value, 365);
			time = new Date().toLocaleString();
			setCookie('time', time, 365);
			document.getElementById('timeLog').innerHTML = 'Last sign-in: ' + time;
			alert('Thanks for signing in!');
		}
	</script>
</head>
<body onload="loadBehaviors()">
	<h1>MPC Sign In</h1>
	<iframe name="dummyframe" id="dummyframe" style="display: none;"></iframe>
	<form action="https://docs.google.com/forms/d/e/1FAIpQLSeB-7HrhLZ3aPJWRNSky3K5caHqCuPTsZPrzR33bXAvzfXtQQ/formResponse" method="POST" target="dummyframe">
		<p>Type your K email below:</p>
		<input type="text" id="email" name="entry.1333753580" required style="width: 90%">
		<br>
		<input type="submit" value="Submit" onclick="submitBehaviors()">
	</form>
	<p id="timeLog"></p>
</body>
</html>